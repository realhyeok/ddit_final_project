<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Mail-Mapper">
	<select id="selectReceiveMailList" resultType="mailVO">
		SELECT MAIL_NO
			 , TITLE
			 , USER_FROM
			 , CONTENT
			 , REGDATE
		  FROM MAIL
		 WHERE USER_TO = #{userTo}
		   AND DIST = 'B901'
		   AND SENT_DEL = '1'
		 ORDER BY REGDATE DESC
	</select>
	
	<select id="selectSendMailList" resultType="mailVO">
		SELECT MAIL_NO
			 , TITLE
			 , USER_TO
			 , USER_FROM
			 , CONTENT
			 , REGDATE
			 , STATUS
			 , DIST
			 , RECV_DEL
			 , SENT_DEL
		  FROM MAIL
		 WHERE USER_FROM = #{userFrom}
		   AND DIST = 'B901'
		   AND SENT_DEL = '1'
		 ORDER BY REGDATE DESC
	</select>
	
	<select id="selectTempMailList" resultType="mailVO">
		SELECT MAIL_NO
			 , TITLE
			 , USER_TO
			 , USER_FROM
			 , CONTENT
			 , REGDATE
			 , STATUS
			 , DIST
			 , RECV_DEL
			 , SENT_DEL
		  FROM MAIL
		 WHERE USER_FROM = #{userFrom}
		   AND DIST = 'B902'
		   AND SENT_DEL = '1'
		 ORDER BY REGDATE DESC
	</select>
	
	<select id="selectTrashMailList" resultType="mailVO">
		SELECT MAIL_NO
			 , TITLE
			 , USER_TO
			 , USER_FROM
			 , CONTENT
			 , REGDATE
			 , STATUS
			 , DIST
			 , RECV_DEL
			 , SENT_DEL
		  FROM MAIL
		 WHERE (USER_TO = #{userTo} AND RECV_DEL = '2')
			OR (USER_FROM = #{userFrom} AND SENT_DEL = '2')
		 ORDER BY REGDATE DESC
	</select>
	
	<select id="selectMailDetail" resultType="mailVO">
		SELECT MAIL_NO
			 , TITLE
			 , USER_TO
			 , USER_FROM
			 , CONTENT
			 , REGDATE
			 , STATUS
		  FROM MAIL
		 WHERE MAIL_NO = #{mailNo}
	</select>
	
	<select id="selectMailAttachList" resultType="attachVO">
		SELECT ATTACH_NO
			 , MAIL_NO
			 , FILE_PATH
			 , FILE_NAME
			 , FILE_TYPE
			 , FILE_SIZE
			 , ATTACHER
			 , REGDATE 
		  FROM ATTACH
		 WHERE MAIL_NO = #{mailNo}
		 ORDER BY FILE_NAME ASC
	</select>
	
	<update id="changeMailStatus">
		UPDATE MAIL
		   SET STATUS = 'A802'
		 WHERE MAIL_NO = #{mailNo}
	</update>
	
	<update id="registMail">
		INSERT INTO MAIL (
			  MAIL_NO
			, TITLE
			, USER_TO
			, USER_FROM
			, CONTENT
			, REGDATE
			, STATUS
			, DIST
			, RECV_DEL
			, SENT_DEL
			) VALUES (
			  #{mailNo}
			, #{title}
			, #{userTo}
			, #{userFrom}
			, #{content}
			, SYSDATE
			, 'A801'
			, 'B901'
			, '1'
			, '1'
			)
	</update>
	
	<update id="registAttachFile">
		INSERT INTO ATTACH (
			  ATTACH_NO
			, MAIL_NO
			, FILE_PATH
			, FILE_NAME
			, FILE_TYPE
			, FILE_SIZE
			, ATTACHER
			, REGDATE
		) VALUES (
			  1
			, #{mailNo}
			, #{filePath}
			, #{fileName}
			, #{fileType}
			, #{fileSize}
			, #{attacher}
			, SYSDATE
		)
	</update>
</mapper>



